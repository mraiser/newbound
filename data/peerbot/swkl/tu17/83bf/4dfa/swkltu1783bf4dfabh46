{"data":{"css":".rebootselectedbutton{\n  display:none;\n  margin-top:40px;\n}\n\n.rebootablepeerstable{\n  white-space: normal;\n}\n","data":[],"name":"rebootemall","js":"var me = this; \nvar ME = $('#'+me.UUID)[0];\n\nme.ready = function(){\n  json('../peerbot/getpeerinfo', null, function(result){\n    me.my_uuid = result.id;\n    if (!document.peers){\n      json('../peerbot/connections', null, function(result){\n        if (result.status == 'ok') {\n          me.peers = document.peers = result.data;\n          buildTable();\n        }\n      });\n    }\n    else {\n      me.peers = document.peers;\n      buildTable();\n    }\n  });\n};\n\nfunction buildTable(){\n  me.checking = [];\n  var newhtml = '';\n  for (var uuid in me.peers){\n    var p = me.peers[uuid];\n    if (p.connected){\n      me.checking.push(uuid);\n      newhtml += '<tr class=\"uprow r_'+uuid+'\" data-peer=\"'+uuid+'\">'\n        + '<td class=\"mdl-data-table__cell--non-numeric\">'+p.name+'<br><div style=\"font-size:x-small;\">'+uuid+'<\/div><\/td>'\n        + '<\/tr>';\n    }\n  }\n  if (newhtml != ''){\n    newhtml = '<table class=\"updateablepeerstable mdl-data-table mdl-js-data-table mdl-data-table--selectable mdl-shadow--2dp\"><thead><tr><th class=\"mdl-data-table__cell--non-numeric\">Peer<\/th><\/tr><\/thead><tbody>'\n      + newhtml\n      + '<\/tbody><\/table>';\n  }\n  else newhtml = '<i>You are not connected to any peers.<\/i>';\n  \n  var el = $(ME).find('.reboot_peer_list');\n  el.html(newhtml);\n  \n  $(ME).find('.rebootselectedbutton').css('display', 'inline-block');\n  \n  componentHandler.upgradeAllRegistered();\n}\n\nfunction rebootNextPeer(){\n  var checkbox = $(ME).find('td').find(':checked')[0];\n  if (checkbox) {\n    var row = checkbox.closest('.uprow');\n    var uuid = $(row).data('peer');\n    me.currentlyupdating = uuid;\n    $(checkbox).prop('checked', false).parent().css('display', 'none').after('<div class=\"mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active rebootspinner\"><\/div>');\n    componentHandler.upgradeAllRegistered();\n    \n    json('../peerbot/remote/'+uuid+'/metabot/call', 'db=metabot&name=rebootbutton&cmd=reboot&args={}', function(result){\n      if (result.status != 'ok') alert(result.msg);\n      else row.remove();\n    });\n    rebootNextPeer();\n  }\n  else{\n    me.updating = false;\n    me.currentlyupdating = null;\n    var n = $(ME).find('td').find(':checkbox').length;\n    if (n == 0) {\n      var el = $(ME).find('.reboot_peer_list');\n      el.html('<h3>Your peers have been rebooted.<\/h3>');\n    }\n  }\n}\n\n$(ME).find('.rebootselectedbutton').click(function(e){\n  if (!me.updating){\n    me.updating = true;\n    rebootNextPeer();\n  }\n});\n","groups":"","ctl":"swkltu1783bf4dfabh46","html":"<div class='reboot_peer_list'><\/div>\n<button class=\"rebootselectedbutton mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored\">\n  Reboot Selected\n<\/button>\n","three":{"controls":[]},"db":"peerbot","desc":""},"id":"swkltu1783bf4dfabh46","sessionid":"jvgvwg16b7a4d277bt3","time":1615919222038,"addr":"/0:0:0:0:0:0:0:1:33376","username":"admin"}