{"data":{"css":"","data":[],"name":"controlselect","js":"var me = this;\nvar ME = $('#'+me.UUID)[0];\n\nvar cbs = [];\n\nvar l = ME.DATA.label ? ME.DATA.label : 'Select a Control';\nvar a = ME.DATA.allownone ? true : false;\n\nvar cdb = null;\nvar cid = null;\n\nme.ready = function(){\n  var val = ME.DATA.value;\n  if (val){\n    var i = val.indexOf(':');\n    cdb = val.substring(0,i);\n    cid = val.substring(i+1);\n  }\n\n  var lib = ME.DATA.lib;\n  if (lib) me.setLibrary(lib);\n  else {\n    var args = {\n      value: cdb,\n      allownone:a,\n      ready:function(api){\n        me.setLibrary(api.value());\n      },\n      cb:me.setLibrary\n    };\n    installControl($(ME).find('.ctlsellibwrap')[0], 'metabot', 'libraryselect', function(){}, args);\n  }\n  if (ME.DATA.cb) me.change(ME.DATA.cb);\n};\n\nme.setLibrary = function(lib){\n  me.lib = cdb = lib;\n  var ccb = function(val){\n    cid = val;\n    for (var i in cbs) cbs[i](val, cid);\n  };\n  json('../botmanager/read', 'db='+lib+'&id=controls', function(result){\n    var ctllist = me.ctllist = result.data ? result.data.list : [];\n    var data = {\n      value:cid,\n      label: l,\n      list: ctllist,\n      allownone:a,\n      ready:function(api){\n        if (ME.DATA.ready) ME.DATA.ready(me);\n        ccb(api.value());\n      },\n      cb:ccb\n    };\n\n    installControl($(ME).find('.ctlselwrap')[0], 'metabot', 'select', function(api){}, data);\n  });\n};\n\nme.change = function(cb){\n  cbs.push(cb);\n};\n  \nme.value = function(){\n  return $(ME).find('.ctlselwrap').find('select').val();\n};\n  \nme.name = function(){\n  var val = $(ME).find('.ctlselwrap').find('select').val();\n  val = getByProperty(me.ctllist, 'id', val);\n  return val.name;\n};\n","groups":"anonymous","ctl":"hvpjyl161f1e5abcft4761","html":"<div class='ctlsellibwrap'><\/div>\n<div class='ctlselwrap'><\/div>","three":{"controls":[]},"db":"metabot","desc":""},"readers":["anonymous"],"id":"hvpjyl161f1e5abcft4761","sessionid":"jvgvwg16b7a4d277bt3","time":1574954038222,"addr":"/0:0:0:0:0:0:0:1:49188","username":"admin"}