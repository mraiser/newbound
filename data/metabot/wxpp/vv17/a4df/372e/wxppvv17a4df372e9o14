{"data":{"css":"","data":[],"name":"behaviorlist","js":"var me = this;\nvar ME = $('#'+me.UUID)[0];\n\nme.ready = function(api){\n  componentHandler.upgradeAllRegistered();\n  \n  var list = me.list = ME.DATA.behaviors;\n  rebuildBehaviors();\n};\n\nme.dirty = function(){\n  me.parent.dirty();\n};\n\nfunction rebuildBehaviors(){\n  var list = me.list;\n  var el = $(ME).find('.blist');\n  var newhtml = null;\n  if (list.length == 0) newhtml = '<i>No behaviors defined<\/i><br><br>';\n  else{\n    newhtml = '<ul class=\"demo-list-behavior mdl-list\">';\n    for (var i in list){\n      var ctl = list[i];\n      var name = ctl.name ? ctl.name : ctl.id;\n      var params = '';\n      for (var j in ctl.params){\n        if (j != 0) params += ', ';\n        params += ctl.params[j].name;\n      }\n      newhtml += '<li class=\"mdl-list__item mdl-list__item--one-line\" data-index=\"'+i+'\" id=\"li_'+ctl.id+'\"><a class=\"mdl-list__item-secondary-action delctl\" href=\"#\"><i class=\"material-icons\">delete<\/i><\/a>&nbsp;&nbsp;<span class=\"clickme editbehavior\">me.'+name+' = function('+params+');<\/span><\/li>';\n    }\n    newhtml += '<\/ul>';\n  }\n  el.html(newhtml);\n  el.find('.delctl').click(function(e){\n    var i = $(this).closest('.mdl-list__item').data(\"index\");\n    me.list.splice(i,1);\n    me.parent.dirty();\n    rebuildBehaviors();\n  });\n  el.find('.editbehavior').click(function(e){\n    var i = $(this).closest('.mdl-list__item').data(\"index\");\n    var d = me.list[i];\n    var el = $('#'+me.parent.UUID).find('.editbehaviorhere');\n    installControl(el[0], 'metabot', 'editbehavior', function(api){\n      api.parent = me;\n    }, d);\n  });\n};\nme.rebuildBehaviors = rebuildBehaviors;\n\n$(ME).find('.newbehaviorbutton').click(function(e){\n  var id1 = guid();\n  var id2 = guid();\n  var chooselang = $('<div style=\"color:#83bc00;font-size:12px\">Language:<\/div><label class=\"mdl-radio mdl-js-radio mdl-js-ripple-effect\" for=\"'+id1+'\"><input type=\"radio\" id=\"'+id1+'\" class=\"mdl-radio__button\" name=\"options\" value=\"1\" checked><span class=\"mdl-radio__label\">Javascript<\/span><\/label><br><label class=\"mdl-radio mdl-js-radio mdl-js-ripple-effect\" for=\"'+id2+'\"><input type=\"radio\" id=\"'+id2+'\" class=\"mdl-radio__button\" name=\"options\" value=\"2\"><span class=\"mdl-radio__label\">Flow<\/span><\/label>');\n  \n  var d = {};\n  d.title = \"New Behavior\";\n  d.text = \"Behavior Name\";\n  d.cb = function(val){\n    var lang = chooselang.find('#'+id2).prop('checked') ? 'flow' : 'js';\n    var d = {};\n    d.name = val;\n    d.lang = lang;\n    d.params = [];\n    d.body = \"var me = this;\\nvar ME = $('#'+me.UUID)[0];\\n\\n\";\n    d.id = guid();\n    me.list.push(d);\n    me.parent.dirty();\n    rebuildBehaviors();\n  };\n  \n  var i = 1;\n  while(getByProperty(me.list, \"name\", \"behavior\"+i) != null) i++;\n  d.value = \"behavior\"+i;\n  installControl($(ME).find('.popmeup')[0], 'metabot', 'promptdialog', function(api){\n    $(ME).find('form').append(chooselang);\n    $(ME).find('.subtext').css('display', 'none');\n    $(ME).find('.thin2').css('height', '140px');\n    componentHandler.upgradeAllRegistered();\n  }, d);\n});","groups":"","ctl":"wxppvv17a4df372e9o14","html":"<h4>Behaviors<\/h4>\n<div class='blist'><\/div>\n<button class=\"newbehaviorbutton mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored\">\n  <i class=\"material-icons\">add<\/i>\n<\/button>\n<div class='popmeup'><\/div>","three":{"controls":[],"assets":[],"behaviors":[],"animations":[],"poses":[]},"db":"metabot","desc":""},"id":"wxppvv17a4df372e9o14","sessionid":"jvgvwg16b7a4d277bt3","time":1626112877367,"addr":"/0:0:0:0:0:0:0:1:38526","username":"admin"}