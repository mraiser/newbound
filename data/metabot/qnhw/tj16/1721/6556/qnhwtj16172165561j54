{"data":{"java":"String appid = appinfo.getString(\"id\");\n\nJSONArray libs = appinfo.getJSONArray(\"libraries\");\nString lib = libs.getString(0); // FIXME - Assumes app is in lib 0\n\n//File libzip = new File(metabot.getRootDir(), \"libraries\");\n//File libjson = new File(libzip, lib+\".json\");\n\n//JSONObject libinfo = new JSONObject(new String(metabot.readFile(libjson)));\n//libzip = new File(libzip, lib+\"_\"+libinfo.getInt(\"version\")+\".zip\");\n\n//File tmp = metabot.newTempFile();\n//metabot.unZip(libzip, tmp);\n\n//File src = new File(tmp, \"_APPS\");\n//src = new File(src, appid);\nFile dst = new File(metabot.getRootDir().getParentFile(), appid);\n//metabot.copyFolder(src, dst);\n//metabot.deleteDir(tmp);\n\nString libstring = lib;\nint n = libs.length();\nint i;\nfor (i=1;i<n;i++) libstring += \",\"+libs.getString(i);\n\nJSONArray gen = appinfo.getJSONArray(\"generate\");\nn = gen.length();\nString genstring = n == 0 ? \"\" : gen.getString(0);\nfor (i=1;i<n;i++) genstring += \",\"+gen.getString(i);\n\nFile f = new File(dst, \"app.properties\");\nProperties p = f.exists() ? metabot.loadProperties(f) : new Properties();\n\np.setProperty(\"ctldb\", lib);\np.setProperty(\"id\", appid);\np.setProperty(\"libraries\", libstring);\np.setProperty(\"generate\", genstring);\nif (appinfo.has(\"hash\")) p.setProperty(\"hash\", appinfo.getString(\"hash\"));\nif (appinfo.has(\"botclass\")) p.setProperty(\"botclass\", appinfo.getString(\"class\"));\nif (appinfo.has(\"author\")) p.setProperty(\"author\", appinfo.getString(\"author\"));\nif (appinfo.has(\"authorname\")) p.setProperty(\"authorname\", appinfo.getString(\"authorname\"));\nif (appinfo.has(\"authororg\")) p.setProperty(\"authororg\", appinfo.getString(\"authororg\"));\nif (appinfo.has(\"version\")) p.setProperty(\"version\", appinfo.getString(\"version\"));\nif (appinfo.has(\"index\")) p.setProperty(\"index\", appinfo.getString(\"index\"));\nif (appinfo.has(\"signature\")) p.setProperty(\"signature\", appinfo.getString(\"signature\"));\nif (appinfo.has(\"id\")) p.setProperty(\"id\", appinfo.getString(\"id\"));\nif (appinfo.has(\"price\")) p.setProperty(\"price\", \"\"+appinfo.getDouble(\"price\"));\nif (appinfo.has(\"forsale\")) p.setProperty(\"forsale\", \"\"+appinfo.getBoolean(\"forsale\"));\nif (appinfo.has(\"desc\")) p.setProperty(\"desc\", appinfo.getString(\"desc\"));\nif (appinfo.has(\"vendorversion\")) p.setProperty(\"vendorversion\", appinfo.getString(\"vendorversion\"));\nif (appinfo.has(\"vendor\")) p.setProperty(\"vendor\", appinfo.getString(\"vendor\"));\nif (appinfo.has(\"key\")) p.setProperty(\"key\", appinfo.getString(\"key\"));\nif (appinfo.has(\"img\")) p.setProperty(\"img\", appinfo.getString(\"img\"));\nif (appinfo.has(\"name\")) p.setProperty(\"name\", appinfo.getString(\"name\"));\n              \nmetabot.storeProperties(p, f);\n\nreturn \"OK\";","import":"import java.io.*;\nimport java.util.*;\nimport org.json.*;\nimport java.net.*;\nimport com.newbound.robot.*;\nimport com.newbound.robot.published.*;\nimport java.nio.channels.*;","returntype":"String","params":[{"name":"metabot","type":"Bot"},{"name":"appinfo","type":"JSONObject"}],"desc":"Deprecated. Do not use."},"id":"qnhwtj16172165561j54","sessionid":"jhtpuq15d03ce0a74q0","time":1527962243529,"username":"mraiser"}