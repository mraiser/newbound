{"data":{"timer":[],"css":".padmain{\n  margin-left:50px;\n  margin-right:50px;\n}\n\n.publish-apptable, .publish-libtable{\n  display:inline-block;\n  vertical-align:top;\n  padding-right:50px;\n}\n\n#bjstep2, #bjstep3{\n  display:none;\n}\n\n.popmeup{\n  position:absolute;\n  display:none;\n  width:360px;\n  height:280px;\n}\n\n.thevalue{\n  width:300px;\n}","data":[],"name":"publish","js":"var me = this;\nvar ME = $('#'+me.UUID)[0];\n\nme.ready = function(){\n  componentHandler.upgradeAllRegistered();\n};\n\nfunction send_build(data, cb){\n  var args = {data: data};\n  args = encodeURIComponent(JSON.stringify(args));\n  json('../botmanager/execute', 'db=metabot&id=vuoqjj1615ce507a3i410&args='+args, function(result){\n    cb(result);\n  });\n}\n\nfunction send_package(data, cb){\n  var args = {data: data};\n  args = encodeURIComponent(JSON.stringify(args));\n  json('../botmanager/execute', 'db=metabot&id=nnmxis1664f8be389zd4&args='+args, function(result){\n    cb(result);\n  });\n}\n\n$(ME).find('.step1button').click(function(){\n  $(ME).find('.bjpanel').css('display', 'none');\n  $(ME).find('#bjstep1').css('display', 'block');\n});\n\n$(ME).find('.step2button').click(function(){\n  $(ME).find('.bjpanel').css('display', 'none');\n  $(ME).find('#bjstep2').css('display', 'block');\n});\n\n$(ME).find('.step3button').click(function(){\n  $(ME).find('.bjpanel').css('display', 'none');\n  $(ME).find('#bjstep3').css('display', 'block');\n  \n\n  var CURAPPS = [];\n  $(ME).find('.pubappid.is-selected').each(function(x,y){\n    var id = y.id.substring(9);\n    var app = getByProperty(me.apps, 'id', id);\n    CURAPPS.push(app.class);\n//    for (var i in app.libraries) if (CURLIBS.indexOf(app.libraries[i]) == -1) CURLIBS.push(app.libraries[i]);\n  });  \n\n  var CURLIBS = [];\n  $(ME).find('.publibid.is-selected').each(function(x,y){\n    var id = y.id.substring(9);\n    CURLIBS.push(id);\n  });  \n\n  var data = {};\n      \n  data.apps = CURAPPS;\n  data.libs = CURLIBS;\n  data.default = $(ME).find('.pubappstartupselect').find('select').val();\n  data.port = $('#pubapphttpport').val();\n  data.name = $('#pubappname').val();\n  data.icon = $('#thevalue').val();\n  data.native = $('#pubappnative').prop('checked');\n                                 \n  function handle(result){\n    if (result.status == 'ok') $('#bjstep3').html('Your executable source archive has been built: <a data-role=\"none\" data-ajax=\"false\" target=\"_blank\" href=\"'+result.data.jar+'?id='+guid()+'\">download<\/a><br><br><a data-ajax=\"false\" data-role=\"button\" data-theme=\"b\" href=\"index.html\">DONE<\/a>').trigger(\"create\");\n    else $('#bjstep3').html('<font color=\"red\">ERROR: '+result.msg+'<\/font>');\n    \n    if (data.native){\n      $('#bjstep3').prepend('Your native app has been built: <a data-role=\"none\" data-ajax=\"false\" target=\"_blank\" href=\"'+result.data.app+'?id='+guid()+'\">download<\/a><br>');\n    }\n  };\n  \n  if (data.native) send_package(data, handle);\n  else send_build(data, handle);\n});\n\nme.setApps = function(apps){\n  apps.label = 'Startup App';\n  installControl($(ME).find('.pubappstartupselect')[0], 'metabot', 'select', function(){}, apps);\n\n  me.appdata = apps;\n  me.apps = [];\n  for (var i in apps.list) me.apps.push(apps.list[i]);\n  me.apps.sort(function(a,b) {return (a.name.toLowerCase() > b.name.toLowerCase()) ? 1 : ((b.name.toLowerCase() > a.name.toLowerCase()) ? -1 : 0);} ); \n  buildApps(me.apps);\n  if (me.libs) init();\n};\n\nfunction buildApps(apps){\n  var newhtml = '<table class=\"mdl-data-table mdl-js-data-table mdl-data-table--selectable mdl-shadow--2dp inline\"><thead><tr><th class=\"mdl-data-table__cell--non-numeric\">Apps<\/th><\/tr><\/thead><tbody class=\"publish-applist\">';\n  for (var i in apps){\n    var app = apps[i];\n    newhtml += '<tr id=\"pubappid_'+app.id+'\" class=\"pubappid\"><td class=\"mdl-data-table__cell--non-numeric\">'\n      + app.name\n      + '<\/td><\/tr>';\n  }\n  newhtml += '<\/tbody><\/table>';\n  \n  $(ME).find('.publish-apptable').html(newhtml).on('change', appclick);\n  componentHandler.upgradeAllRegistered();\n}\n\nfunction appclick(e){\n  init();\n  \n  $(ME).find('.pubappid.is-selected').each(function(x,y){\n  var id = y.id.substring(9);\n  var app = getByProperty(me.apps, 'id', id);\n    for (var i in app.libraries){\n      var el = $('#publibid_'+app.libraries[i]).find('.mdl-checkbox');\n      el.closest('tr').addClass('is-selected');\n      el[0].MaterialCheckbox.check();\n    }\n  });\n}\n\nme.setLibs = function(libs){\n  me.libs = libs;\n  buildLibs(libs);\n  if (me.apps) init();\n};\n\nfunction buildLibs(libs){\n  var newhtml = '<table class=\"mdl-data-table mdl-js-data-table mdl-data-table--selectable mdl-shadow--2dp inline\"><thead><tr><th class=\"mdl-data-table__cell--non-numeric\">Libraries<\/th><\/tr><\/thead><tbody class=\"publish-liblist\">';\n  for (var i in libs){\n    var lib = libs[i];\n    newhtml += '<tr id=\"publibid_'+lib.id+'\" class=\"publibid\"><td class=\"mdl-data-table__cell--non-numeric\">'\n      + lib.name\n      + '<\/td><\/tr>';\n  }\n  newhtml += '<\/tbody><\/table>';\n  \n  $(ME).find('.publish-libtable').html(newhtml).on('change', libclick);\n  componentHandler.upgradeAllRegistered();\n}\n\nfunction libclick(e){\n  init();\n  \n  $(ME).find('.publibid').each(function(x,y){\n    if (!$(y).hasClass('is-selected')){\n      var id = y.id.substring(9);\n      var lib = getByProperty(me.libs, 'id', id);\n      \n      for (var i in lib.apps){\n        var el = $('#pubappid_'+lib.apps[i]).find('.mdl-checkbox');\n        el.closest('tr').removeClass('is-selected');\n        el[0].MaterialCheckbox.uncheck();\n      }\n    }\n  });\n}\n\nfunction init(){\n  \n  for (var i in me.apps){\n    var app = me.apps[i];\n    for (var j in app.libraries){\n      var lib = getByProperty(me.libs, 'id', app.libraries[j]);\n      if (lib){\n        if (!lib.apps) lib.apps = [];\n        if (lib.apps.indexOf(app.id) == -1) lib.apps.push(app.id);\n      }\n    }\n  }\n  \n  var el = $('#pubappid_botmanager').find('.mdl-checkbox');\n  el.closest('tr').addClass('is-selected');\n  el[0].MaterialCheckbox.check();\n  \n  el = $('#pubappid_metabot').find('.mdl-checkbox');\n  el.closest('tr').addClass('is-selected');\n  el[0].MaterialCheckbox.check();\n  \n  el = $('#pubappid_securitybot').find('.mdl-checkbox');\n  el.closest('tr').addClass('is-selected');\n  el[0].MaterialCheckbox.check();\n  \n  el = $('#pubappid_peerbot').find('.mdl-checkbox');\n  el.closest('tr').addClass('is-selected');\n  el[0].MaterialCheckbox.check();\n  \n  el = $('#publibid_peerbot').find('.mdl-checkbox');\n  el.closest('tr').addClass('is-selected');\n  el[0].MaterialCheckbox.check();\n  \n  el = $('#publibid_securitybot').find('.mdl-checkbox');\n  el.closest('tr').addClass('is-selected');\n  el[0].MaterialCheckbox.check();\n  \n  el = $('#publibid_botmanager').find('.mdl-checkbox');\n  el.closest('tr').addClass('is-selected');\n  el[0].MaterialCheckbox.check();\n  \n  el = $('#publibid_metabot').find('.mdl-checkbox');\n  el.closest('tr').addClass('is-selected');\n  el[0].MaterialCheckbox.check();\n  \n//  el = $('#publibid_taskbot').find('.mdl-checkbox');\n//  el.closest('tr').addClass('is-selected');\n//  el[0].MaterialCheckbox.check();\n  \n//  el = $('#publibid_Koreapps').find('.mdl-checkbox');\n//  el.closest('tr').addClass('is-selected');\n//  el[0].MaterialCheckbox.check();\n  \n//  el = $('#publibid_dashboard').find('.mdl-checkbox');\n//  el.closest('tr').addClass('is-selected');\n//  el[0].MaterialCheckbox.check();\n  \n  el = $('#publibid_threejs').find('.mdl-checkbox');\n  el.closest('tr').addClass('is-selected');\n  el[0].MaterialCheckbox.check();\n}\n\n$(ME).find('.assetpickerbutton').click(function(event) {\n  data = {\n  };\n  installControl($(ME).find('.assetpicker')[0], 'metabot', 'assetselect', function(api){\n    me.picker = api;    \n    installControl($(ME).find('.popmeup')[0], 'metabot', 'popupdialog', function(api){}, {});\n  }, data);\n});\n\nme.select = function(){\n  var lib = me.picker.lib;\n  var val = me.picker.value();\n  var url = lib+':'+val;\n  $(ME).find('.thevalue').val(url);\n  $(ME).find('.closeme').click();\n};\n\n","groups":"anonymous","html":"<div class='padmain'>\n  <h3>Build Executable<\/h3>\n  <div class='bjpanel' id='bjstep1'>\n    <b>Step 1 - Select Apps and Libraries<\/b>\n    <br><br>\n    <button class=\"mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored step2button\">\n      Next\n    <\/button>\n    <br><br>\n    <div class=\"publish-apptable\"><\/div>\n    <div class=\"publish-libtable\"><\/div>\n  <\/div>\n  <div class='bjpanel' id='bjstep2'>\n    <b>Step 2 - Customize Executable<\/b>\n    <br><br>\n    <div>\n      <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label\">\n        <input class=\"mdl-textfield__input\" type=\"text\" id=\"pubappname\" value=\"Untitled\">\n        <label class=\"mdl-textfield__label\" for=\"pubappname\">Executable Name<\/label>\n      <\/div>\n      <div class='pubappstartupselect'><\/div>\n      <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label\">\n        <input class=\"mdl-textfield__input\" type=\"text\" id=\"pubapphttpport\" value=\"5773\">\n        <label class=\"mdl-textfield__label\" for=\"pubapphttpport\">HTTP Port<\/label>\n      <\/div>\n      \n<div class='hideme'>\n      <label class=\"mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect\" for=\"pubappnative\">\n        <input type=\"checkbox\" id=\"pubappnative\" class=\"mdl-checkbox__input\">\n        <span class=\"mdl-checkbox__label\">Build native app<\/span>\n      <\/label>\n      <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label\">\n        <input class=\"mdl-textfield__input thevalue\" type=\"text\" id=\"thevalue\" value=\"metabot:icon-square-app-builder.png\">\n        <label class=\"mdl-textfield__label\" for=\"thevalue\">Icon<\/label>\n      <\/div>\n      <button class=\"mdl-button mdl-js-button mdl-button--icon assetpickerbutton\">\n        <i class=\"material-icons\">list<\/i>\n      <\/button>\n<\/div>\n\n      \n      \n      \n      \n      \n      <br><br>\n    <\/div>\n    <button class=\"mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent step1button\">\n      back\n    <\/button>\n    <button class=\"mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored step3button\">\n      build\n    <\/button>\n    <br><br>\n  <\/div>\n  <div class='bjpanel' id='bjstep3'>\n    <i>Building archive, please wait...<\/i>\n  <\/div>\n<\/div>\n<br><br>\n<div class='popmeup'>\n  <div class=\"mdl-card__title\">\n    <h2 class=\"mdl-card__title-text\">Select an Asset<\/h2>\n  <\/div>\n  <div class=\"mdl-card__title mdl-card--expand\">\n    <div class='assetpicker'><\/div>\n  <\/div>\n  <div class=\"mdl-card__actions mdl-card--border\">\n    <a class=\"mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect chooseassetbutton\" onclick=\"$(this).closest('.popmeup').parent()[0].api.select();\">\n      select\n    <\/a>\n  <\/div>\n  <div class=\"mdl-card__menu\">\n    <button class=\"mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect closeme\" onclick=\"$(this).closest('.popmeup')[0].api.closeAndReset();\">\n      <i class=\"material-icons\">close<\/i>\n    <\/button>\n  <\/div>\n<\/div>    ","ctl":"isnkou1615cde5967t3a7","cmd":[{"java":"yugkkk1615ce507a1o40f","name":"build","id":"vuoqjj1615ce507a3i410"},{"java":"yztxwo1664f8be381wd3","name":"package","id":"nnmxis1664f8be389zd4"}],"three":{"controls":[]},"db":"metabot","desc":""},"readers":["anonymous"],"id":"isnkou1615cde5967t3a7","sessionid":"jvgvwg16b7a4d277bt3","time":1598544994598,"addr":"/0:0:0:0:0:0:0:1:43496","username":"admin"}