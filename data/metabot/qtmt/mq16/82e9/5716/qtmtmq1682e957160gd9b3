{"data":{"css":".ctllistwrap::-webkit-scrollbar {\n    width: 4px;\n}\n \n.ctllistwrap::-webkit-scrollbar-track {\n    -webkit-box-shadow: inset 0 0 6px rgba(255,255,255,0.3);\n}\n \n.ctllistwrap::-webkit-scrollbar-thumb {\n  background-color: darkgrey;\n  outline: 1px solid slategrey;\n}\n\n.fullwidth {\n  position:absolute;\n  top:0px;\n  left:0px;\n  width:100%;\n  height:100%;\n  background-color:black;\n}\n\n.ctllistwrap{\n  color:#fff8;\n  width:200px;\n  height:100%;\n  position:absolute;\n  top:0px;\n  left:0px;\n  overflow-y:scroll;\n  padding-left:20px;\n  padding-right:20px;\n}\n\n.mdl-list__item{\n  color:#fff8;\n  width:100%;\n}\n\n.mdl-list__item--two-line .mdl-list__item-primary-content .mdl-list__item-sub-title{\n  color:#fff8;\n  width:100%;\n  overflow:hidden;\n  font-size:xx-small;\n}\n\n.editctl, .delctl{\n  cursor:pointer;\n}\n\n.edit3dhere{\n  position:absolute;\n  top:20px;\n  left:265px;\n  display:none;\n  vertical-align:top;\n}\n\n.edit3dhere .mdl-textfield{\n  vertical-align:bottom;\n}\n\n.edit3dhere .mdl-textfield__label, .edit3dhere .mdl-textfield__input, .edit3dhere table{\n  color:#fff8;\n}","data":[],"name":"edit3d","js":"var me = this;\nvar ME = $('#'+me.UUID)[0];\n\nme.ready = function(api){\n  componentHandler.upgradeAllRegistered();\n\n  var el = $(ME).find('.matrixviewer');\n  el.data('orbitcontrols', true);\n  el.data('showdatgui', false);\n  \n  function addModel(el, ctl, cb){\n    me.viewer.add(el[0], ctl.db, ctl.id, function(model){\n/*\n      var m1 = $('#'+ctl.uuid)[0].api;\n      m1.rig.pos_x = ctl.pos.x;\n      m1.rig.pos_y = ctl.pos.y;\n      m1.rig.pos_z = ctl.pos.z;\n      m1.rig.rot_x = ctl.rot.x;\n      m1.rig.rot_y = ctl.rot.y;\n      m1.rig.rot_z = ctl.rot.z;\n      m1.rig.scale_x = ctl.scale.x;\n      m1.rig.scale_y = ctl.scale.y;\n      m1.rig.scale_z = ctl.scale.z;\n*/      \n      cb();\n    }, ctl);\n  }\n  \n  installControl(el[0], 'threejs', 'viewer', function(api){\n    me.viewer = api;\n    api.waitReady(function(){\n      me.data = ME.DATA;\n      if (!me.data) me.data = {};\n      if (!me.data.three) me.data.three = { \"controls\": [] };\n      var l = me.queue = me.data.three.controls.slice();\n      var popnext = me.popnext = function(){\n        if (l.length>0){\n          var ctl = l.shift();\n          if (!ctl.uuid) ctl.uuid = guid();\n          var el = $('<div id=\"'+ctl.uuid+'\"/>');\n          console.log(JSON.stringify(ctl));\n          $('body').append(el);\n          addModel(el, ctl, popnext);\n        }\n        else start();\n      };\n      popnext();\n    });\n  }, {});\n};\n\nfunction dirty(){\n  $('.savebutton').removeClass('mdl-button--accent').addClass('mdl-button--colored');\n}\n\nfunction start(){\n  var newhtml = '<ul class=\"demo-list-two mdl-list\">';\n  for (var i in me.data.three.controls){\n    var ctl = me.data.three.controls[i];\n    var name = ctl.name ? ctl.name : ctl.id;\n    newhtml += '<li class=\"mdl-list__item mdl-list__item--two-line\" data-index=\"'+i+'\" id=\"li_'+ctl.uuid+'\"><span class=\"mdl-list__item-primary-content editctl\"><span class=\"namespan\">'+name+'<\/span><span class=\"mdl-list__item-sub-title\">'+ctl.db+':'+ctl.id+'<\/span><\/span><a class=\"mdl-list__item-secondary-action delctl\" href=\"#\"><i class=\"material-icons\">delete<\/i><\/a><\/li>';\n  }\n  newhtml += '<\/ul>';\n  var el = $(ME).find('.ctllist');\n  el.html(newhtml);\n  el.find('.delctl').click(function(){\n    var i = $(this).closest('li').data('index');\n    var d = me.data.three.controls.splice(i,1);\n    start();\n    var m1 = $('#'+d[0].uuid)[0].api;\n    me.viewer.removeModel(m1);\n  });\n  el.find('.editctl').click(function(){\n    var i = $(this).closest('li').data('index');\n    var d = me.data.three.controls[i];\n    var m1 = $('#'+d.uuid)[0].api;\n\n    me.edit3d = d;\n    $('#edit3dctlname').val(d.name).parent()[0].MaterialTextfield.checkDirty();\n\n    d.pos = d.pos ? d.pos : {\"x\":0,\"y\":0,\"z\":0};\n    d.rot = d.rot ? d.rot : {\"x\":0,\"y\":0,\"z\":0};\n    d.scale = d.scale ? d.scale : {\"x\":1,\"y\":1,\"z\":1};\n    \n    var vpos = {\n      \"value\": d.pos,\n      \"cb\":function(val){\n        m1.rig.pos_x = val.x;\n        m1.rig.pos_y = val.y;\n        m1.rig.pos_z = val.z;\n        dirty();\n      }\n    };\n    var vrot = {\n      \"value\": d.rot,\n      \"cb\":function(val){\n        m1.rig.rot_x = val.x;\n        m1.rig.rot_y = val.y;\n        m1.rig.rot_z = val.z;\n        dirty();\n      }\n    };\n    var vscale = {\n      \"value\": d.scale,\n      \"cb\":function(val){\n        m1.rig.scale_x = val.x;\n        m1.rig.scale_y = val.y;\n        m1.rig.scale_z = val.z;\n        dirty();\n      }\n    };\n    installControl('#edit3dctlpos', 'threejs', 'vector3', function(api){}, vpos);\n    installControl('#edit3dctlrot', 'threejs', 'vector3', function(api){}, vrot);\n    installControl('#edit3dctlscale', 'threejs', 'vector3', function(api){}, vscale);\n\n    $('#edit3dctlinner').empty();\n    $('.edit3dhere').css('display', 'block');\n    if (m1.api.edit) {\n      m1.api.edit('#edit3dctlinner', function(val){\n        dirty();\n      });\n    }\n  });\n}\n\n$('#add3dctlbutton').click(function(){\n  var api = $('#new3dctl')[0].api;\n  var lib = api.lib;\n  var ctl = api.value();\n  var name = api.name();\n\n  var d = {\n    \"name\":name,\n    \"id\":ctl,\n    \"db\":lib\n  };\n  me.queue.push(d);\n  me.popnext();\n  me.data.three.controls.push(d);\n  start();\n});\n\n$('#edit3dctlname').change(function(){\n  var el = $('#li_'+me.edit3d.uuid);\n  me.edit3d.name = $(this).val();\n  el.find('.namespan').text(me.edit3d.name);\n  dirty();\n});","groups":"","ctl":"qtmtmq1682e957160gd9b3","html":"<div class='fullwidth matrixviewer'><\/div>\n<div class='ctllistwrap'>\n  <h3>Controls<\/h3>\n  <div class='ctllist'><\/div>\n  <div id='new3dctl' class='data-control' data-control='metabot:controlselect'><\/div>\n  <button class=\"mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored\" id=\"add3dctlbutton\">\n    <i class=\"material-icons\">add<\/i>\n  <\/button>  \n<\/div>\n<div class='edit3dhere'>\n  <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label\">\n    <input class=\"mdl-textfield__input\" type=\"text\" id=\"edit3dctlname\">\n    <label class=\"mdl-textfield__label\" for=\"edit3dctlname\">Name<\/label>\n  <\/div>\n  <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label is-dirty\">\n    <div id='edit3dctlpos'><\/div>\n    <label class=\"mdl-textfield__label\" for=\"edit3dctlpos\">Position<\/label>\n  <\/div>\n  <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label is-dirty\">\n    <div class='data-control' data-control='threejs:vector3' id='edit3dctlrot'><\/div>\n    <label class=\"mdl-textfield__label\" for=\"edit3dctlrot\">Rotation<\/label>\n  <\/div>\n  <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label is-dirty\">\n    <div class='data-control' data-control='threejs:vector3' id='edit3dctlscale'><\/div>\n    <label class=\"mdl-textfield__label\" for=\"edit3dctlscale\">Scale<\/label>\n  <\/div>\n  <div id='edit3dctlinner'><\/div>\n<\/div>","three":{"controls":[]},"db":"metabot","desc":""},"id":"qtmtmq1682e957160gd9b3","sessionid":"jhtpuq15d03ce0a74q0","time":1549124038831,"addr":"/0:0:0:0:0:0:0:1:57979","username":"mraiser"}