{"data":{"css":".fullscreen {\n  position:fixed;\n  top:0px;\n  left:0px;\n  width:100%;\n  height:100%;\n}\n\n.matrixbg{\n  background-color:#333300;\n}\n\n.sideshow{\n  position:fixed;\n  top:0px;\n  left:-100%;\n  height:100%;\n  max-width:340px;\n  padding:20px;\n  overflow-y:auto;\n  background-color:#fffd;\n}","data":[],"name":"editor","js":"var me = this;\nvar ME = $('#'+me.UUID)[0];\n\nme.mdb = ME.DATA.mdb ? ME.DATA.mdb : 'runtime';\nme.mid = ME.DATA.mid ? ME.DATA.mid : 'threejs_modellist';\n\nme.ready = function(){\n  componentHandler.upgradeAllRegistered();\n  \n  var el = $(ME).find('.matrixviewer');\n  el.data('orbitcontrols', true);\n  el.data('showdatgui', true);\n  installControl(el[0], 'threejs', 'viewer', function(api){\n    me.viewer = api;\n    api.waitReady(function(){\n      var el = $(ME).find('.libraryselect');\n      var data = {\n        allowadd:true,\n        ready: function(api){\n          selectLibrary(api.value());\n        },\n        cb: function(val){\n          selectLibrary(val);\n        }\n      };\n      installControl(el[0], 'metabot', 'libraryselect', function(api){\n        sideshow('side_libselect');\n      }, data);\n    });\n  }, {});\n};\n\nfunction sideshow(claz){\n  $(ME).find('.ssselected').animate({left:\"-100%\"},500);\n  $(ME).find('.'+claz).addClass('ssselected').animate({left:\"0px\"},500);\n}\n\nfunction selectLibrary(val){\n  me.mdb = val;\n  var data = {\n    mdb: me.mdb,\n    mid: me.mid,\n    ready: function(api){},\n    cb: function(val){\n      selectModel(val);\n    }\n  };\n  var el = $(ME).find('.modellist');\n  installControl(el[0], 'threejs', 'modellist', function(api){\n    me.modellist = api;\n  }, data);\n}\n\nfunction rebuildModel(){\n  if (me.modelapi) {\n      me.viewer.removeModel(me.modelapi);\n  }\n  var el = $(ME).find('.loadmodel');\n  el.data('metadata', me.model);\n  var assets = me.model.assets;\n  me.viewer.loadModel(el[0], assets, {list:['threejs:poseanimation']}, null, null, null, null, function(model){\n    me.modelapi = me.viewer.modelapi = model;\n  });\n}\n\nfunction selectModel(val){\n  me.model = val;\n  var data = {\n    model: val,\n    cb: function(val, skiprebuild){\n      me.modellist.saveModels();\n      if (!skiprebuild) rebuildModel();\n    }, \n    viewer:me.viewer\n  };\n  var el = $(ME).find('.side_editmodel');\n  installControl(el[0], 'threejs', 'modeleditor', function(api){\n    me.modeleditor = api;\n    sideshow('side_editmodel');\n    el.find('.closeeditmodelbutton').click(function(){\n      sideshow('side_libselect');\n    });\n  }, data);\n  rebuildModel();\n}\n\n$(document).click(function(event){\n  window.lastElementClicked = event.target;\n});\n","groups":"","ctl":"qmyurx166b6d9030fk107c","html":"<div class='fullscreen matrixbg'>\n  <div class='fullscreen matrixviewer'><\/div>\n<\/div>\n<div class='sideshow side_libselect'>\n  <div class='libraryselect'><\/div>\n  <h3>Models<\/h3>\n  <div class='modellist'><\/div>\n<\/div>\n<div class='sideshow side_editmodel'><\/div>\n<div class='loadmodel' id='Model'><\/div>","db":"threejs","desc":""},"id":"qmyurx166b6d9030fk107c","sessionid":"jhtpuq15d03ce0a74q0","time":1541096188760,"addr":"/0:0:0:0:0:0:0:1:62912","username":"mraiser"}