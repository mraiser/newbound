{"data":{"css":".model-card-image.mdl-card{\n  width:128px;\n  height:128px;\n  min-height:128px;\n  background-color:black;\n  background-position:center;\n  background-size:cover;\n  margin-bottom:10px;\n}\n\n.model-card-image__filename{\n  color:#fff;\n  font-size:14px;\n  font-weight:bold;\n}\n\n.model-card-image > .mdl-card__actions{\n  height:40px;\n  padding:12px;\n  background:rgba(0,0,0,0.5);\n  cursor:pointer;\n}\n\n.model-card-image > .mdl-card__menu{\n  background-color:#0008;\n  color:#fff;\n  top:0px;\n  right:0px;\n  border-radius:20px;\n}\n","data":[],"name":"modellist","js":"var me = this;\nvar ME = $('#'+me.UUID)[0];\n\nme.models = [];\nme.mdb = ME.DATA.mdb ? ME.DATA.mdb : 'runtime';\nme.mid = ME.DATA.mid ? ME.DATA.mid : 'threejs_modellist';\n\nme.ready = function(){\n  componentHandler.upgradeAllRegistered();\n  $.getJSON('../botmanager/read', 'db='+me.mdb+'&id='+me.mid, function(result){\n    if (result.data && result.data.models) me.models = result.data.models;\n    rebuildModels();\n  });\n};\n\nfunction saveModels(){\n  var data = { models: me.models };\n  $.getJSON('../botmanager/write?db='+me.mdb+'&id='+me.mid+'&data='+encodeURIComponent(JSON.stringify(data)), function(result){\n    rebuildModels();\n  });\n}\nme.saveModels = saveModels;\n\nfunction rebuildModels(){\n  var newhtml = '';\n  for (var i in me.models){\n    var m = me.models[i];\n    newhtml += '<div data-index=\"'+i+'\" class=\"model-card-image mc'+i+' mdl-card mdl-shadow--2dp\" style=\"background-image:url('+m.thumbnail+');\"><div class=\"mdl-card__title mdl-card--expand\"><\/div><div class=\"mdl-card__actions selectmodel\"><span class=\"model-card-image__filename\">'+m.name+'<\/span><\/div><div class=\"mdl-card__menu\"><button class=\"mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect deletemodelbutton\"><i class=\"material-icons\">delete<\/i><\/button><\/div><\/div>';\n  }\n  var el = $(ME).find('.modellistwrap');\n  el.html(newhtml);\n  el.find('.deletemodelbutton').click(function(){\n    var i = $(this).closest('.model-card-image').data('index');\n    var data = {\n      title:\"Delete Model\",\n      text:\"Are you sure you want to delete this model?\",\n      cb:function(){\n        me.models.splice(i,1);\n        saveModels();\n      }\n    }\n    installControl($(ME).find('.killmodelpopup')[0], 'metabot', 'confirmdialog', function(result){}, data);\n  });\n  el.find('.selectmodel').click(function(){\n    var i = $(this).closest('.model-card-image').data('index');\n    var m = me.models[i];\n    if (ME.DATA.cb) ME.DATA.cb(m);\n  });\n}\n\n$(ME).find('.addmodel').click(function(){\n  var data = {\n    id: guid(),\n    name: \"Untitled\",\n    lib: me.mdb,\n    thumbnail: \"../botmanager/asset/threejs/3d.png\",\n    assets:[]\n  };\n  me.models.unshift(data);\n  saveModels();\n  if (ME.DATA.cb) ME.DATA.cb(data);\n});\n\n$(document).click(function(event){\n  window.lastElementClicked = event.target;\n});\n","groups":"","ctl":"qurgpy166b6e8287fw1167","html":"<div class='modellistwrap'><\/div>\n<button class=\"mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored addmodel\">\n  <i class=\"material-icons\">add<\/i>\n<\/button>\n<div class='newmodelpopup'><\/div>\n<div class='killmodelpopup'><\/div>","db":"threejs","desc":""},"id":"qurgpy166b6e8287fw1167","sessionid":"jhtpuq15d03ce0a74q0","time":1541003946071,"addr":"/0:0:0:0:0:0:0:1:53503","username":"mraiser"}